{% extends "core/base.html" %}
{% load static %}

{% block title %}Registro Rápido - Organic Shops{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-[#f8faf9] to-[#f0f4f1] py-12">
    <div class="max-w-md mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-white rounded-2xl shadow-[0_20px_50px_rgba(8,_112,_84,_0.1)] border border-gray-100 overflow-hidden">
            <!-- Header -->
            <div class="px-6 py-6 bg-gradient-to-r from-[#3e5740] to-[#2d4030]">
                <div class="text-center">
                    <div class="h-12 w-12 rounded-full bg-white/20 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user-plus text-2xl text-white"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-white">Registro Rápido</h2>
                    <p class="text-[#f0f4f1] text-sm">Completa tu registro en segundos</p>
                </div>
            </div>

            <div class="p-6">
                {% if messages %}
                    {% for message in messages %}
                        <div class="mb-4 p-4 rounded-lg {% if message.tags == 'error' %}bg-red-50 border border-red-200 text-red-700{% else %}bg-[#f8faf9] border border-[#d9e2db] text-[#2d4030]{% endif %}">
                            <div class="flex items-center">
                                <i class="fas {% if message.tags == 'error' %}fa-exclamation-circle{% else %}fa-check-circle{% endif %} mr-2"></i>
                                {{ message }}
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}

                <form method="post" class="space-y-4">
                    {% csrf_token %}
                    
                    <!-- Nombre -->
                    <div class="space-y-2">
                        <label for="{{ form.nombre.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.nombre.label }} *
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-user text-gray-400"></i>
                            </div>
                            {{ form.nombre }}
                        </div>
                        {% if form.nombre.errors %}
                            <p class="text-xs text-red-600">{{ form.nombre.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Email -->
                    <div class="space-y-2">
                        <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.email.label }} *
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-envelope text-gray-400"></i>
                            </div>
                            {{ form.email }}
                        </div>
                        {% if form.email.errors %}
                            <p class="text-xs text-red-600">{{ form.email.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Username -->
                    <div class="space-y-2">
                        <label for="{{ form.username.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.username.label }} *
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-at text-gray-400"></i>
                            </div>
                            {{ form.username }}
                        </div>
                        {% if form.username.errors %}
                            <p class="text-xs text-red-600">{{ form.username.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Password -->
                    <div class="space-y-2">
                        <label for="{{ form.password.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.password.label }} *
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-lock text-gray-400"></i>
                            </div>
                            {{ form.password }}
                        </div>
                        {% if form.password.errors %}
                            <p class="text-xs text-red-600">{{ form.password.errors.0 }}</p>
                        {% endif %}
                        {% if form.password.help_text %}
                            <p class="text-xs text-gray-500">{{ form.password.help_text }}</p>
                        {% endif %}
                    </div>

                    <!-- DNI -->
                    <div class="space-y-2">
                        <label for="{{ form.dni.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.dni.label }} *
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-id-card text-gray-400"></i>
                            </div>
                            {{ form.dni }}
                        </div>
                        {% if form.dni.errors %}
                            <p class="text-xs text-red-600">{{ form.dni.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500">7-8 dígitos sin puntos</p>
                    </div>

                    <!-- Ciudad -->
                    <div class="space-y-2">
                        <label for="{{ form.ciudad.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.ciudad.label }} *
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-map-marker-alt text-gray-400"></i>
                            </div>
                            {{ form.ciudad }}
                        </div>
                        {% if form.ciudad.errors %}
                            <p class="text-xs text-red-600">{{ form.ciudad.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Domicilio -->
                    <div class="space-y-2">
                        <label for="{{ form.domicilio.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.domicilio.label }}
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-home text-gray-400"></i>
                            </div>
                            {{ form.domicilio }}
                        </div>
                        {% if form.domicilio.errors %}
                            <p class="text-xs text-red-600">{{ form.domicilio.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Botones -->
                    <div class="flex flex-col space-y-3 pt-4">
                        <button type="submit" 
                                class="w-full bg-gradient-to-r from-[#3e5740] to-[#2d4030] text-white px-4 py-3 rounded-lg font-semibold hover:from-[#2d4030] hover:to-[#1f2b20] focus:outline-none focus:ring-2 focus:ring-[#f8faf9]0 focus:ring-offset-2 transition-all duration-300 flex items-center justify-center space-x-2">
                            <i class="fas fa-user-plus"></i>
                            <span>Crear Cuenta</span>
                        </button>
                        
                        <a href="{% url 'core:checkout' %}" 
                           class="w-full bg-white border-2 border-gray-300 text-gray-700 px-4 py-3 rounded-lg font-semibold hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-300 flex items-center justify-center space-x-2">
                            <i class="fas fa-arrow-left"></i>
                            <span>Volver al Checkout</span>
                        </a>
                    </div>
                </form>

                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600">
                        ¿Ya tienes cuenta? 
                        <a href="{% url 'core:login' %}" class="text-[#3e5740] hover:text-[#2d4030] font-medium">
                            Inicia sesión aquí
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const dniInput = document.getElementById('dni');
    
    // Validación del DNI en tiempo real
    dniInput.addEventListener('input', function() {
        const dni = this.value.replace(/\D/g, ''); // Solo números
        this.value = dni;
        
        if (dni.length < 7 || dni.length > 8) {
            this.setCustomValidity('El DNI debe tener entre 7 y 8 dígitos');
            this.classList.add('border-red-500');
            this.classList.remove('border-[#f8faf9]0');
        } else {
            this.setCustomValidity('');
            this.classList.remove('border-red-500');
            this.classList.add('border-[#f8faf9]0');
        }
    });
});
</script>
{% endblock %}
