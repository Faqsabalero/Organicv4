{% extends "core/base.html" %}

{% block title %}Registrar Usuario - Organic Shops{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-green-50 to-green-100 py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-2xl mx-auto animate-scaleIn">
        <!-- Card Container -->
        <div class="bg-white rounded-2xl shadow-enhanced border border-gray-100 overflow-hidden relative">
            <!-- Decorative Elements -->
            <div class="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-green-100 to-green-200 rounded-full transform translate-x-20 -translate-y-20 opacity-50"></div>
            <div class="absolute bottom-0 left-0 w-40 h-40 bg-gradient-to-tr from-green-100 to-green-200 rounded-full transform -translate-x-20 translate-y-20 opacity-50"></div>

            <!-- Header -->
            <div class="relative px-6 py-6 bg-gradient-to-r from-green-600 to-green-700 text-white">
                <div class="flex items-center space-x-4">
                    <div class="h-12 w-12 rounded-full overflow-hidden border-2 border-white shadow-lg">
                        <img src="https://storage.googleapis.com/a1aa/image/6aaebe32-d6ed-4dec-96f6-ff630ed08f4d.jpg" 
                             alt="Logo" class="h-full w-full object-cover">
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold">Registrar Nuevo Usuario</h2>
                        <p class="text-green-200 text-sm">Complete el formulario para crear una nueva cuenta</p>
                    </div>
                </div>
            </div>

            <!-- Formulario -->
            <div class="p-8">
                <form method="post" class="space-y-6">
                    {% csrf_token %}
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Username -->
                        <div class="space-y-2">
                            <label for="{{ form.username.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Nombre de Usuario
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-user text-gray-400"></i>
                                </div>
                                {{ form.username }}
                                {% if form.username.errors %}
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                    <i class="fas fa-exclamation-circle text-red-500"></i>
                                </div>
                                {% endif %}
                            </div>
                            {% if form.username.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.username.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Nombre -->
                        <div class="space-y-2">
                            <label for="{{ form.nombre.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Nombre Completo
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-id-card text-gray-400"></i>
                                </div>
                                {{ form.nombre }}
                            </div>
                            {% if form.nombre.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.nombre.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Email -->
                        <div class="space-y-2">
                            <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Correo Electr√≥nico
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-envelope text-gray-400"></i>
                                </div>
                                {{ form.email }}
                            </div>
                            {% if form.email.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.email.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- DNI -->
                        <div class="space-y-2">
                            <label for="{{ form.dni.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                DNI
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-id-badge text-gray-400"></i>
                                </div>
                                {{ form.dni }}
                            </div>
                            {% if form.dni.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.dni.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Ciudad -->
                        <div class="space-y-2">
                            <label for="{{ form.ciudad.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Ciudad
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-city text-gray-400"></i>
                                </div>
                                {{ form.ciudad }}
                            </div>
                            {% if form.ciudad.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.ciudad.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Provincia -->
                        <div class="space-y-2">
                            <label for="{{ form.provincia.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Provincia
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-map-marker-alt text-gray-400"></i>
                                </div>
                                {{ form.provincia }}
                            </div>
                            {% if form.provincia.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.provincia.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Domicilio -->
                        <div class="space-y-2">
                            <label for="{{ form.domicilio.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Domicilio
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-home text-gray-400"></i>
                                </div>
                                {{ form.domicilio }}
                            </div>
                            {% if form.domicilio.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.domicilio.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Rol -->
                        <div class="space-y-2">
                            <label for="{{ form.rol.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Rol
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-user-tag text-gray-400"></i>
                                </div>
                                {{ form.rol }}
                            </div>
                            {% if form.rol.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.rol.errors.0 }}
                            </p>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Distribuidor Exclusivo -->
                    <div id="distribuidor-exclusivo" class="hidden bg-green-50 p-4 rounded-lg border border-green-200 mt-4">
                        <div class="flex items-center space-x-3">
                            <input type="checkbox" name="es_distribuidor_exclusivo" id="es_distribuidor_exclusivo" 
                                   class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded transition-colors duration-200">
                            <label for="es_distribuidor_exclusivo" class="text-sm text-gray-700 flex items-center">
                                <i class="fas fa-star text-yellow-400 mr-2"></i>
                                Distribuidor Exclusivo
                            </label>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                        <!-- Password -->
                        <div class="space-y-2">
                            <label for="{{ form.password1.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Contrase√±a
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-lock text-gray-400"></i>
                                </div>
                                {{ form.password1 }}
                            </div>
                            {% if form.password1.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.password1.errors.0 }}
                            </p>
                            {% endif %}
                        </div>

                        <!-- Confirm Password -->
                        <div class="space-y-2">
                            <label for="{{ form.password2.id_for_label }}" class="block text-sm font-medium text-gray-700">
                                Confirmar Contrase√±a
                            </label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-lock text-gray-400"></i>
                                </div>
                                {{ form.password2 }}
                            </div>
                            {% if form.password2.errors %}
                            <p class="text-red-600 text-sm mt-1 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                {{ form.password2.errors.0 }}
                            </p>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="flex justify-end mt-6">
                        <button type="submit" 
                                class="px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white font-medium rounded-lg hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-300 hover:scale-[1.02] flex items-center space-x-2">
                            <i class="fas fa-user-plus"></i>
                            <span>Registrar Usuario</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    // Estilizar inputs
    const inputs = [
        'username', 'nombre', 'email', 'dni', 'ciudad', 'rol', 'password1', 'password2'
    ];

    inputs.forEach(input => {
        const element = document.getElementById(`id_${input}`);
        if (element) {
            element.classList.add(
                'pl-10',
                'form-input',
                'block',
                'w-full',
                'rounded-lg',
                'border-gray-300',
                'focus:ring-green-500',
                'focus:border-green-500',
                'transition-colors',
                'duration-200'
            );
        }
    });

    // Mostrar/ocultar opci√≥n de distribuidor exclusivo
    document.getElementById('{{ form.rol.id_for_label }}').addEventListener('change', function() {
        const distribuidorExclusivoDiv = document.getElementById('distribuidor-exclusivo');
        if (this.value === 'DISTRIBUIDOR') {
            distribuidorExclusivoDiv.classList.remove('hidden');
            distribuidorExclusivoDiv.classList.add('animate-fadeIn');
        } else {
            distribuidorExclusivoDiv.classList.add('hidden');
            distribuidorExclusivoDiv.classList.remove('animate-fadeIn');
            document.getElementById('es_distribuidor_exclusivo').checked = false;
        }
    });
</script>
{% endblock %}
